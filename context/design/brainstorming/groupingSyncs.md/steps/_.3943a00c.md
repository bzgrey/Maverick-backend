---
timestamp: 'Tue Nov 18 2025 22:24:07 GMT-0500 (Eastern Standard Time)'
parent: '[[../20251118_222407.ae85ecd1.md]]'
content_id: 3943a00c3cd403b41fe042e28515bb027f74e3bcee1d284e4dc0d6fb040cb457
---

# Grouping Syncs

## `src/syncs/grouping/create_group.sync.ts`

```sync
sync CreateGroupRequest
when
	Requesting.request (path: "/groups/create", session, groupName: string) : (request)
where
	Sessioning._getUser (session) gets user: {user }
then
	Grouping.createGroup (owner: User, groupName)

sync CreateGroupResponse
when
	Requesting.request (path: "/groups/create") : (request)
	Grouping.createGroup () : (group: { id: string, name: string, ownerId: string })
then
	Requesting.respond (request, group)

sync CreateGroupResponseError
when
	Requesting.request (path: "/groups/create") : (request)
	Grouping.createGroup () : (error: { code: string, message: string })
then
	Requesting.respond (request, error)
```

***

## `src/syncs/grouping/add_member.sync.ts`

```sync
sync AddMemberRequest
when
	Requesting.request (path: "/groups/addMember", session, groupId: string, memberId: string) : (request)
where
	Sessioning._getUser (session) gets requester: { id: string, username: string }
	User._getUserById (id: memberId) gets memberToAdd: { id: string, username: string }
	Grouping._getGroup (id: groupId) gets group: { id: string, name: string, ownerId: string }, owner: groupOwner: { id: string, username: string }
	// Only the group owner can add members.
	requester.id is groupOwner.id
	// Neither the requester nor the memberToAdd should have blocked the other.
	not Blocking._isBlocked (userA: memberToAdd, userB: requester)
	not Blocking._isBlocked (userA: requester, userB: memberToAdd)
then
	Grouping.addMember (group: group, member: memberToAdd)

sync AddMemberResponse
when
	Requesting.request (path: "/groups/addMember") : (request)
	Grouping.addMember () : (success: { message: string, addedMemberId: string })
then
	Requesting.respond (request, success)

sync AddMemberResponseError
when
	Requesting.request (path: "/groups/addMember") : (request)
	Grouping.addMember () : (error: { code: string, message: string })
then
	Requesting.respond (request, error)
```

***

## `src/syncs/grouping/remove_member.sync.ts`

```sync
sync RemoveMemberRequest
when
	Requesting.request (path: "/groups/removeMember", session, groupId: string, memberId: string) : (request)
where
	Sessioning._getUser (session) gets requester: { id: string, username: string }
	User._getUserById (id: memberId) gets memberToRemove: { id: string, username: string }
	Grouping._getGroup (id: groupId) gets group: { id: string, name: string, ownerId: string }, owner: groupOwner: { id: string, username: string }
	// Requester is either the group owner OR the member themselves.
	(requester.id is groupOwner.id) or (requester.id is memberToRemove.id)
then
	Grouping.removeMember (group: group, member: memberToRemove)

sync RemoveMemberResponse
when
	Requesting.request (path: "/groups/removeMember") : (request)
	Grouping.removeMember () : (success: { message: string, removedMemberId: string })
then
	Requesting.respond (request, success)

sync RemoveMemberResponseError
when
	Requesting.request (path: "/groups/removeMember") : (request)
	Grouping.removeMember () : (error: { code: string, message: string })
then
	Requesting.respond (request, error)
```

***

## `src/syncs/grouping/delete_group.sync.ts`

```sync
sync DeleteGroupRequest
when
	Requesting.request (path: "/groups/delete", session, groupId: string) : (request)
where
	Sessioning._getUser (session) gets requester: { id: string, username: string }
	Grouping._getGroup (id: groupId) gets group: { id: string, name: string, ownerId: string }, owner: groupOwner: { id: string, username: string }
	// Only the group owner can delete the group.
	requester.id is groupOwner.id
then
	Grouping.deleteGroup (group: group)

sync DeleteGroupResponse
when
	Requesting.request (path: "/groups/delete") : (request)
	Grouping.deleteGroup () : (success: { message: string, deletedGroupId: string })
then
	Requesting.respond (request, success)

sync DeleteGroupResponseError
when
	Requesting.request (path: "/groups/delete") : (request)
	Grouping.deleteGroup () : (error: { code: string, message: string })
then
	Requesting.respond (request, error)
```

***

## `src/syncs/grouping/get_group_members.sync.ts`

```sync
// Scenario 1: Group has members, respond with them
sync GetGroupMembersRequestWithMembers
when
	Requesting.request (path: "/groups/members", session, groupId: string) : (request)
where
	Sessioning._getUser (session) gets requester: { id: string, username: string }
	Grouping._getGroup (id: groupId) gets group: { id: string, name: string, ownerId: string }
	// Requester must be a member of the group to view its members.
	Grouping._isMember (group: group, member: requester)
	Grouping._getMembersCount (group: group) gets count: number
	count > 0
	// Query for members and their usernames
	Grouping._getMembers (group: group) gets member: { id: string }
	User._getUsername (user: member) gets memberUsername: string
	results is frames.collectAs([member, memberUsername], results)
then
	Requesting.respond (request, results: array< { member: { id: string }, memberUsername: string } >)

// Scenario 2: Group has no members, but request was valid, respond with empty array
sync GetGroupMembersRequestNoMembers
when
	Requesting.request (path: "/groups/members", session, groupId: string) : (request)
where
	Sessioning._getUser (session) gets requester: { id: string, username: string }
	Grouping._getGroup (id: groupId) gets group: { id: string, name: string, ownerId: string }
	Grouping._isMember (group: group, member: requester)
	Grouping._getMembersCount (group: group) gets count: number
	count is 0
	results is []
then
	Requesting.respond (request, results: array<any>)

// Scenario 3: Request failed due to an error in a concept action
sync GetGroupMembersResponseError
when
	Requesting.request (path: "/groups/members") : (request)
	AnyConceptAction() : (error: { code: string, message: string })
then
	Requesting.respond (request, error)
```

***

## `src/syncs/grouping/get_my_groups.sync.ts`

```sync
// Scenario 1: User is a member of one or more groups
sync GetMyGroupsRequestWithGroups
when
	Requesting.request (path: "/groups/my-groups", session) : (request)
where
	Sessioning._getUser (session) gets requester: { id: string, username: string }
	Grouping._getGroupsCountForUser (user: requester) gets count: number
	count > 0
	Grouping._getGroupsForUser (user: requester) gets group: { id: string }
	Grouping._getGroupDetails (group: group) gets groupName: string, groupOwner: { id: string }
	User._getUsername (user: groupOwner) gets groupOwnerUsername: string
	results is frames.collectAs([group, groupName, groupOwner, groupOwnerUsername], results)
then
	Requesting.respond (request, results: array< { group: { id: string }, groupName: string, groupOwner: { id: string }, groupOwnerUsername: string } >)

// Scenario 2: User is not a member of any groups
sync GetMyGroupsRequestNoGroups
when
	Requesting.request (path: "/groups/my-groups", session) : (request)
where
	Sessioning._getUser (session) gets requester: { id: string, username: string }
	Grouping._getGroupsCountForUser (user: requester) gets count: number
	count is 0
	results is []
then
	Requesting.respond (request, results: array<any>)

// Scenario 3: Request failed due to an error in a concept action
sync GetMyGroupsResponseError
when
	Requesting.request (path: "/groups/my-groups") : (request)
	AnyConceptAction() : (error: { code: string, message: string })
then
	Requesting.respond (request, error)
```
